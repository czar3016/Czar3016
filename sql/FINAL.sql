DROP TABLE ONHAND_IV;
DROP TABLE PUBLISHEDWORKS;
DROP TABLE SALES;
DROP TABLE BOOKS;
DROP TABLE AUTHORS;
DROP TABLE BRANCHES;
DROP TABLE PUBLISHERS;
DROP TABLE CUSTOMERS;
DROP TABLE CATEGORIES;

CREATE TABLE CATEGORIES(
	BOOK_CATEGORY		    CHAR(3)   Not Null,
	PRIMARY KEY (BOOK_CATEGORY));
  
CREATE TABLE CUSTOMERS(
	CUS_ID		    CHAR(5)       Not Null,
	CUS_FNAME		  VARCHAR(20)   Not Null,
  CUS_LNAME		  VARCHAR(35)   Not Null,
  CUS_ADDRESS		VARCHAR(50)   Not Null,
  CUS_CITY		  VARCHAR(20)   Not Null,
  CUS_STATE		  CHAR(2)       Not Null,
  CUS_ZIP		    NUMBER(5,0)   Not Null,
  CUS_EMAIL		  VARCHAR(50)   Not Null,
  PRIMARY KEY (CUS_ID));
  
CREATE TABLE PUBLISHERS(
	PUB_CODE		  CHAR(5)       Not Null,
	PUB_NAME		  VARCHAR(35)   Not Null,
  PUB_ADDRESS		VARCHAR(50)   Not Null,
  PUB_CITY		  VARCHAR(20)   Not Null,
  PUB_STATE		  CHAR(2)       Not Null,
  PUB_ZIP		    NUMBER(5,0)   Not Null,
  PUB_PHONE		  NUMBER(10,0),
  PUB_EMAIL		  VARCHAR(50),
  PRIMARY KEY (PUB_CODE));
  
CREATE TABLE BRANCHES(
	BRAN_ID		    CHAR(2)       Not Null,
	BRAN_NAME		  VARCHAR(35)   Not Null,
  BRAN_LOCADD   VARCHAR(50)   Not Null,
  BRAN_CITY		  VARCHAR(20)   Not Null,
  BRAN_STATE		CHAR(2)       Not Null,
  BRAN_ZIP		  NUMBER(5,0)   Not Null,
  BRAN_PHONE	  NUMBER(10,0),
  PRIMARY KEY (BRAN_ID));
  
CREATE TABLE AUTHORS(
	AUTH_NUM		  CHAR(5)       Not Null,
	AUTH_FNAME		VARCHAR(20)   Not Null,
  AUTH_LNAME	  VARCHAR(35)   Not Null,
  PRIMARY KEY (AUTH_NUM));
  
CREATE TABLE BOOKS(
	BOOK_CODE		    CHAR(5)       Not Null,
	TITLE		        VARCHAR(100)  Not Null,
  BOOK_CATEGORY	  CHAR(3)       Not Null,
  BOOK_PRICE	    NUMBER(5,2)   Not Null,
  PAPERBACK_Y     CHAR(1)       Not Null,
  PUB_CODE        CHAR(5)       Not Null,
  PRIMARY KEY (BOOK_CODE),
  FOREIGN KEY (BOOK_CATEGORY) REFERENCES CATEGORIES,
	FOREIGN KEY (PUB_CODE) REFERENCES PUBLISHERS);
  
CREATE TABLE SALES(
	SALE_ID 		    CHAR(5)       Not Null,
	CUS_ID		      CHAR(5)       Not Null,
  BOOK_CODE		    CHAR(5)       Not Null,
  SALE_DATE 	    DATE          Not Null,
  AMOUNT_SOLD     NUMBER(2,0)   Not Null,
  PATMENT_METH    CHAR(4)       Not Null,
  PRIMARY KEY (SALE_ID),
  FOREIGN KEY (CUS_ID) REFERENCES CUSTOMERS,
	FOREIGN KEY (BOOK_CODE) REFERENCES BOOKS);
  
CREATE TABLE PUBLISHEDWORKS(
	AUTH_NUM		      CHAR(5)       Not Null,
  BOOK_CODE		    CHAR(5)       Not Null,
  CONSTRAINT PUBLISHED_PK PRIMARY KEY (AUTH_NUM, BOOK_CODE),
  FOREIGN KEY (AUTH_NUM) REFERENCES AUTHORS,
	FOREIGN KEY (BOOK_CODE) REFERENCES BOOKS);
  
CREATE TABLE ONHAND_IV(
	BRAN_ID		      CHAR(2)       Not Null,
  BOOK_CODE		    CHAR(5)       Not Null,
  ONHAND_AMOUNT   NUMBER(2,0)   Not Null,
  REORDER_LEVEL   NUMBER(2,0),
  CONSTRAINT ONHAND_PK PRIMARY KEY (BRAN_ID, BOOK_CODE),
  FOREIGN KEY (BRAN_ID) REFERENCES BRANCHES,
	FOREIGN KEY (BOOK_CODE) REFERENCES BOOKS);
  
DESC ONHAND_IV;
DESC PUBLISHEDWORKS;
DESC SALES;
DESC BOOKS;
DESC AUTHORS;
DESC BRANCHES;
DESC PUBLISHERS;
DESC CUSTOMERS;
DESC CATEGORIES;

COMMIT;
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/YYYY';

INSERT INTO CATEGORIES VALUES('CS');  
INSERT INTO CATEGORIES VALUES('MYS'); 
INSERT INTO CATEGORIES VALUES('FIC');

INSERT INTO CUSTOMERS VALUES(25986, 'Larry', 'Fine', '12 Knuckle Lane', 'Austin', 'TX', 73301,'jojoad@gmail.com');  
INSERT INTO CUSTOMERS VALUES(28546, 'Moe', 'Howard', '1 Florence Rd', 'Boston', 'MA', 02108, 'notthatfx@gmail.com'); 
INSERT INTO CUSTOMERS VALUES(35874, 'Curly', 'Arby', '3 Flapjack Cir.', 'Denver', 'CO', 80123, 'cccsss@gmail.com'); 

INSERT INTO PUBLISHERS VALUES(12123, 'boyd and fraser', '1 Barnet St.', 'Boston', 'MA', 02108, 1115554442, 'sales@bnf.com' );  
INSERT INTO PUBLISHERS VALUES(85690, 'Pocket Books', '6 Sox St.', 'New York', 'NY', 10001, 8965552026, 'sales@pocketbooks.com' ); 
INSERT INTO PUBLISHERS VALUES(63582, 'Bantam Books', '2 Barnet St.', 'New York', 'NY', 10001, NULL, 'sales@bantambooks.com');

INSERT INTO BRANCHES VALUES('BW', 'Brentwood', 'Brentwood Mall', 'Brentwood', 'CO', 30651, 7895554628);  
INSERT INTO BRANCHES VALUES('DT', 'Downtown', '16 Riverview', 'Austin', 'TX', 73301, 8955559872); 
INSERT INTO BRANCHES VALUES('ES','Eastshore', 'Eastshore Mall', 'Boston', 'MA', 02108, 9875556321); 

INSERT INTO AUTHORS VALUES(11111, 'Joseph', 'Adamski');  
INSERT INTO AUTHORS VALUES(22222, 'Jeffery', 'Archer'); 
INSERT INTO AUTHORS VALUES(81664, 'Agatha', 'Christie');

INSERT INTO BOOKS VALUES('CS123', 'Database Systems', 'CS', 54.95, 'N', 12123);  
INSERT INTO BOOKS VALUES('FI123', 'First Among Equals', 'FIC', 3.95, 'Y', 85690); 
INSERT INTO BOOKS VALUES('MY168', 'Death on the Nile', 'MYS', 3.95, 'Y', 63582); 

INSERT INTO SALES VALUES(10001, 25986, 'CS123', '12-09-2002', 1, 'VISA');  
INSERT INTO SALES VALUES(10002, 28546, 'FI123', '12-05-2002', 1, 'MAST'); 
INSERT INTO SALES VALUES(10064, 35874, 'MY168', '12-02-2002', 2, 'CASH');

INSERT INTO PUBLISHEDWORKS VALUES(11111, 'CS123');  
INSERT INTO PUBLISHEDWORKS VALUES(22222, 'FI123'); 
INSERT INTO PUBLISHEDWORKS VALUES(81664, 'MY168'); 

INSERT INTO ONHAND_IV VALUES('BW', 'FI123', 1, 3);  
INSERT INTO ONHAND_IV VALUES('DT', 'MY168', 1, 5); 
INSERT INTO ONHAND_IV VALUES('ES', 'CS123', 2, 3); 

SELECT * FROM ONHAND_IV;
SELECT * FROM PUBLISHEDWORKS;
SELECT * FROM SALES;
SELECT * FROM BOOKS;
SELECT * FROM AUTHORS;
SELECT * FROM BRANCHES;
SELECT * FROM PUBLISHERS;
SELECT * FROM CUSTOMERS;
SELECT * FROM CATEGORIES;

SELECT AUTHORS.AUTH_LNAME, BOOKS.TITLE
FROM AUTHORS, PUBLISHEDWORKS, BOOKS
WHERE AUTHORS.AUTH_NUM = PUBLISHEDWORKS.AUTH_NUM
AND PUBLISHEDWORKS.BOOK_CODE=BOOKS.BOOK_CODE;

SELECT BRANCHES.BRAN_NAME, BOOKS.TITLE, ONHAND_INV.ONHAND_AMOUNT, ONHAND_INV.REORDER_LEVEL
FROM BRANCHES, BOOKS, ONHAND_INV
WHERE BRANCHES.BRAN_ID = ONHAND_INV.BRAN_ID 
AND BOOKS.BOOK_CODE=ONHAND_INV.BOOK_CODE;

SELECT SALES.SALE_ID, CUSTOMERS.CUS_LNAME, CUSTOMERS.CUS_EMAIL,
SALES.SALE_DATE, SALES.PAYMENT_METH, SALES.SALE_TOTAL
FROM SALES, CUSTOMERS
WHERE CUSTOMERS.CUS_ID=SALES.CUS_ID;

SELECT SALES.SALE_ID, LINE.LINE_CODE, BOOKS.TITLE, LINE.AMOUNT_SOLD
FROM SALES, LINE, BOOKS
WHERE SALES.SALE_ID=LINE.SALE_ID AND BOOKS.BOOK_CODE=LINE.BOOK_CODE;

SELECT BOOKS.TITLE, CATEGORIES.BOOK_CATEGORY
FROM BOOKS, CATEGORIES
WHERE CATEGORIES.BOOK_CATEGORY=BOOKS.BOOK_CATEGORY;
